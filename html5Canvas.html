<!DOCTYPE html>
<html>

<head>
    <title>html5 Canvas </title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta name="generator" content="Geany 1.23.1" />
    <style>
    .box{width:200;float:left;margin:5px;}
    h6{margin:0px;}
    </style>
</head>

<body>
    <div id="show"></div>

<script id="tpl" type="text/template">
{@each list as item,index}
<div class="box"><h6>${item}</h6><canvas id="c${item}" data="${item}" width="${item.length-1}0" height="${item.length-1}0" style="border:solid 1px #ccc;">你的浏览器不支持 Canvas 标签</canvas></div>
{@/each}
</script>

<script type="text/javascript" src="http://lib.sinaapp.com/js/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://juicer.name/javascripts/juicer-min.js"></script>

<script >
//生成各种排列组合串
//http://www.myexception.cn/javascript/241624.html
//http://www.blogjava.net/mxx/archive/2006/10/21/76525.html
//http://blog.csdn.net/hackbuteer1/article/details/7462447
function combination(arr){
    var len = arr.length;
    if(len == 0) {
        return []
    }

    if(len == 2){
        var a = arr[0], b = arr[1];
        return [[a,b],[b,a]];
    }

    if(len == 1) {
        return [[arr[0]]];
    }
    var arRtn = [];
    for(var i=0;i <len;i++){
        arRtn = arRtn.concat( merge( arr[i],combination(arr.slice(0,i).concat(arr.slice(i+1,len))) ) );
    }
    return arRtn;

}
function merge(head,arr){
    for(var i=0;i <arr.length;i++)
    arr[i].unshift(head);
    return arr;
}


function get_data(str){
    var ar = combination(str.split(""));
    var data = []
    for(var i=0;i <ar.length;i++){
        data.push(ar[i].join(""));
        console.log(ar[i].join(""));
    }
    return data;
}


</script>

<script>
    //绘制折线图
    function draw(canvasId,strData,unit){
        var data = strData.split('');
        if(data.length==0){
            return ;
        }

        var canvas = document.getElementById(canvasId);
        if(!canvas.getContext){
            alert('not support canvas');
            return;
        }
        var ctx = canvas.getContext('2d');

        ctx.moveTo(0,0);
        for(var i in data){
            x= i * unit;
            y = (data.length-data[i])*unit; //?data.length - data[i]
            ctx.lineTo(x,y);
            ctx.moveTo(x,y);
        }
        ctx.stroke();
    }


    $('#show').html(juicer($('#tpl').html(), {list:get_data('12345')}));
    $('canvas').each(function(){
        var d = $(this).attr('data');
        draw('c'+ d,d,10);
    });


</script>


</body>
</html>
